-- Salva os valores originais da iluminação
local Light = game:GetService("Lighting")
local originalAmbient = Light.Ambient
local originalColorShiftBottom = Light.ColorShift_Bottom
local originalColorShiftTop = Light.ColorShift_Top
local originalClockTime = Light.ClockTime

local RaelHubFunction = {}

function RaelHubFunction.CreateEsp(objeto, cor, imageId, texto)
  if not objeto or not objeto:IsA("Model") or not objeto:FindFirstChild("HumanoidRootPart") then
    return
  end

  local highlight = Instance.new("Highlight")
  highlight.Name = "RaelHubDestaque"
  highlight.Adornee = objeto
  highlight.FillColor = cor
  highlight.Parent = objeto

  local billboard = Instance.new("BillboardGui")
  billboard.Name = "RaelHubIcon"
  billboard.Adornee = objeto:FindFirstChild("HumanoidRootPart")
  billboard.Size = UDim2.new(0, 30, 0, 30)
  billboard.StudsOffset = Vector3.new(0, 0, 0)
  billboard.AlwaysOnTop = true
  billboard.Parent = objeto

  local imageLabel = Instance.new("ImageLabel")
  imageLabel.Size = UDim2.new(1, 0, 1, 0)
  imageLabel.BackgroundTransparency = 1
  imageLabel.Image = "rbxassetid://" .. imageId
  imageLabel.Parent = billboard
  
  local textLabel = Instance.new("TextLabel")
  textLabel.Size = UDim2.new(1, 0, 1, 0)
  textLabel.BackgroundTransparency = 1
  textLabel.Text = texto
  textLabel.Position = UDim2.new(0, 0, 0, 20)
  textLabel.TextColor3 = cor
  textLabel.TextSize = 13
  textLabel.Font = Enum.Font.GothamBold
  textLabel.Parent = billboard
end

function RaelHubFunction.CreateEspObject(objeto, cor, imageId, texto)

  local highlight = Instance.new("Highlight")
  highlight.Name = "RaelHubDestaque"
  highlight.Adornee = objeto
  highlight.FillColor = cor
  highlight.Parent = objeto

  local billboard = Instance.new("BillboardGui")
  billboard.Name = "RaelHubIcon"
  billboard.Adornee = objeto:FindFirstChildOfClass("BasePart")
  billboard.Size = UDim2.new(0, 30, 0, 30)
  billboard.StudsOffset = Vector3.new(0, 0, 0)
  billboard.AlwaysOnTop = true
  billboard.Parent = objeto

  local imageLabel = Instance.new("ImageLabel")
  imageLabel.Size = UDim2.new(1, 0, 1, 0)
  imageLabel.BackgroundTransparency = 1
  imageLabel.Image = "rbxassetid://" .. imageId
  imageLabel.Parent = billboard
  
  local textLabel = Instance.new("TextLabel")
  textLabel.Size = UDim2.new(1, 0, 1, 0)
  textLabel.BackgroundTransparency = 1
  textLabel.Text = texto
  textLabel.Position = UDim2.new(0, 0, 0, 20)
  textLabel.TextColor3 = cor
  textLabel.TextSize = 13
  textLabel.Font = Enum.Font.GothamBold
  textLabel.Parent = billboard
end

function RaelHubFunction.PlayersEspActive()
  local players = game:GetService("Players")
        
  for _, jogador in ipairs(players:GetPlayers()) do
    local personagem = jogador.Character

    if personagem then
      if not personagem:FindFirstChild("RaelHubDestaque") and not personagem:FindFirstChild("RaelHubIcon") then
        RaelHubFunction.CreateEsp(personagem, Color3.fromRGB(144, 238, 144), "117259180607823", jogador.Name)
      end
    end
  end
end

function RaelHubFunction.DisableEsp(objeto)
  if objeto then
    if objeto:FindFirstChild("RaelHubDestaque") and objeto:FindFirstChild("RaelHubIcon") then
      objeto:FindFirstChild("RaelHubDestaque"):Destroy()
      objeto:FindFirstChild("RaelHubIcon"):Destroy()
    end
  end
end

function RaelHubFunction.PlayersEspDisabled()
  local players = game:GetService("Players")
        
  for _, jogador in ipairs(players:GetPlayers()) do
    local personagem = jogador.Character

    if personagem then
      RaelHubFunction.DisableEsp(personagem)
    end
  end
end

function RaelHubFunction.EspPlayer()
  while RaelHubEspState do
    RaelHubFunction.PlayersEspActive()
    task.wait(1) -- Atraso para evitar execução rápida demais
  end
  RaelHubFunction.PlayersEspDisabled() -- Desativa o ESP se o estado mudar para false
end

function RaelHubFunction.EspMonstroActive(Monstros)
  for _, Monstro in ipairs(Monstros) do
    if Monstro then
        RaelHubFunction.CreateEsp(Monstro, Color3.fromRGB(255, 102, 102), "88229448947616", "")
    else
      print("Nenhum monstro encontrado.")
    end
  end
end

function RaelHubFunction.EspMonstroDisabled(Monstros)
  for _, Monstro in ipairs(Monstros) do
    if Monstro then
        RaelHubFunction.DisableEsp(Monstro)
    else
      print("Nenhum monstro encontrado.")
    end
  end
end

function RaelHubFunction.dofullbright()
  Light.Ambient = Color3.new(1, 1, 1)
  Light.ColorShift_Bottom = Color3.new(1, 1, 1)
  Light.ColorShift_Top = Color3.new(1, 1, 1)
  Light.ClockTime = 14 -- Deixa o céu de dia
end

function RaelHubFunction.restoreLighting()
  Light.Ambient = originalAmbient
  Light.ColorShift_Bottom = originalColorShiftBottom
  Light.ColorShift_Top = originalColorShiftTop
  Light.ClockTime = originalClockTime
end

-- Função para obter a lista de jogadores
local function getPlayers()
    local Players = {}
    for _, jogador in ipairs(game.Players:GetPlayers()) do
        table.insert(Players, jogador.Name)
    end
    return Players
end

-- Função para criar dropdown de jogadores e botões na aba Player
function RaelHubFunction.SetupPlayerTab(Tabs)
    local PlayerTab = Tabs.Player

    -- Seção de Teleporte
    local Player_section2 = PlayerTab:AddSection("Teleportar para jogadores")
    
    -- Função para criar um dropdown de jogadores
    local function createPlayerDropdown()
        return Player_section2:AddDropdown("Players", {
            Title = "Player: ",
            Values = getPlayers(),
            Multi = false,
            Default = 1,
        })
    end

    -- Inicializa o dropdown de jogadores
    local PlayersDropdown = createPlayerDropdown()

    -- Atualiza o dropdown quando um jogador entrar ou sair
    local function updateDropdown()
        PlayersDropdown:Destroy()
        PlayersDropdown = createPlayerDropdown()
    end

    game.Players.PlayerAdded:Connect(updateDropdown)
    game.Players.PlayerRemoving:Connect(updateDropdown)

    -- Botão de Teleporte
    PlayerTab:AddButton({
        Title = "Tp teleport",
        Description = "",
        Callback = function()
            local targetPlayerName = PlayersDropdown.Value
            local targetPlayer = game.Players:FindFirstChild(targetPlayerName)
            if targetPlayer and targetPlayer.Character and targetPlayer.Character:FindFirstChild("HumanoidRootPart") then
                game.Players.LocalPlayer.Character.HumanoidRootPart.CFrame = targetPlayer.Character.HumanoidRootPart.CFrame
            else
                print("Não foi possível teleportar. Verifique se o jogador está no jogo e se o personagem está carregado.")
            end
        end
    })

    -- Botão para ajustar a velocidade do jogador
    PlayerTab:AddSlider("Slider", {
        Title = "Velocidade",
        Description = "",
        Default = 25,
        Min = 1,
        Max = 100,
        Rounding = 1,
        Callback = function(Value)
            game.Players.LocalPlayer.Character.Humanoid.WalkSpeed = Value
        end
    })
end

return RaelHubFunction